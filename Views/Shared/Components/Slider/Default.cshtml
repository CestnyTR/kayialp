@model kayialp.ViewModels.Slider.SliderViewModel
@using System.Linq

@{
    var menuItems = string.Join(", ", Enumerable.Repeat("\"\"", Model?.Items?.Count ?? 0));
    var sliderOptionsJson =
        $"{{\"effect\":\"fade\",\"menu\": [{menuItems}],\"heroSlide1\": {{\"swiper-container\": {{\"pagination\": {{\"el\": \".swiper-pagination\", \"clickable\": true }}}}}}}}";
}

@if (Model?.Items != null && Model.Items.Any())
{
  <div class="th-hero-wrapper hero-1" id="hero">
    <div class="swiper th-slider hero-slider-1" id="heroSlide1" data-slider-options='@Html.Raw(sliderOptionsJson)'>
      <div class="swiper-wrapper">
        @foreach (var slide in Model.Items)
        {
          <div class="swiper-slide">
            <div class="hero-inner">
              <div class="th-hero-bg"
                   data-bg-src="@slide.DesktopImageUrl"
                   data-bg-src-desktop="@slide.DesktopImageUrl"
                   data-bg-src-mobile="@slide.MobileImageUrl"></div>

              <div class="hero-1-shape d-none d-lg-block" data-ani="slideinleft" data-ani-delay="0.4s">
                <img src="/img/shape/hero-1-shape.png" alt="hero-shape">
              </div>

              <div class="container">
                <div class="row">
                  <div class="col-xl-9 col-lg-8">
                    <div class="hero-style1">
                      @if (!string.IsNullOrWhiteSpace(slide.Slogan))
                      { <span class="sub-title style1" data-ani="slideinup" data-ani-delay="0.2s">@slide.Slogan</span> }

                      @if (!string.IsNullOrWhiteSpace(slide.Title))
                      { <h1 class="hero-title" data-ani="slideinup" data-ani-delay="0.4s">@slide.Title</h1> }

                      @if (!string.IsNullOrWhiteSpace(slide.Content))
                      { <p class="hero-text text-white" data-ani="slideinup" data-ani-delay="0.6s">@Html.Raw(slide.Content)</p> }

                      <div class="btn-group" data-ani="slideinup" data-ani-delay="0.8s">
                        
                          <a asp-controller="Products" asp-action="Index" asp-route-culture="@ViewData["Culture"]"
                  asp-route-slug='@Html.Localize("pages.layout.productCategory.slug")' 
                    class="th-btn style7 th-icon">
                           @Html.Localize("pages.layout.products") <i class="fa-light fa-arrow-right-long"></i>
                          </a>
                        
                          <a asp-controller="Contact" asp-action="Index" 
                                            asp-route-culture="@ViewData["Culture"]"
                                            asp-route-slug="@Html.Localize("pages.layout.communication.slug")"
                                            class="th-btn style2 th-icon">
                          @Html.Localize("pages.layout.communication")<i class="fa-light fa-arrow-right-long"></i>
                          </a>
                        
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        }
      </div>

      <div class="th-swiper-custom">
        <button data-slider-prev="#heroSlide1" class="slider-arrow slider-prev"><img src="/img/icon/right-arrow.svg" alt=""></button>
        <div class="slider-pagination"></div>
        <button data-slider-next="#heroSlide1" class="slider-arrow slider-next"><img src="/img/icon/left-arrow.svg" alt=""></button>
      </div>
    </div>
  </div>
}

@section Scripts {
<script>
(function(){
  function harden(){
    var el = document.querySelector('#heroSlide1');
    var s = el && el.swiper;
    if(!s) return;

    // kritik parametreler
    s.params.effect = 'fade';
    s.params.fadeEffect = { crossFade: true };
    s.params.speed = 450;
    s.params.watchSlidesProgress = true;
    s.params.preloadImages = false;
    s.params.lazy = true;
    s.params.observer = true;
    s.params.observeParents = true;
    s.params.updateOnWindowResize = true;
    s.update();

    // animasyon sırasında input kilidi (mouse wheel / drag spam'ini filtreler)
    let anim = false;
    s.on('slideChangeTransitionStart', () => { anim = true; });
    s.on('slideChangeTransitionEnd',   () => { anim = false; });

    ['wheel','touchstart','pointerdown','mousedown'].forEach(ev=>{
      el.addEventListener(ev, function(e){
        if(anim){ e.preventDefault(); e.stopPropagation(); }
      }, { passive:false });
    });
  }
  window.addEventListener('load', harden);
})();
</script>

}
